-- Step 1: Set the company ID you want to query
SET @company_id_selector = 1;

-- Step 2: Run the query using the variable
SELECT
    c.CompanyName,
    c.CompanyID,
    DATE_FORMAT(de.EventDate, '%Y-%m-%d') AS DisruptionDate,
    COUNT(de.EventID) AS DisruptionCount
FROM
    Company c
JOIN
    ImpactsCompany ic ON c.CompanyID = ic.AffectedCompanyID
JOIN
    DisruptionEvent de ON ic.EventID = de.EventID
WHERE
    c.CompanyID = @company_id_selector -- Use the variable here
GROUP BY
    c.CompanyID,
    c.CompanyName,
    DisruptionDate
ORDER BY
    DisruptionDate ASC;
